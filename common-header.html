<!DOCTYPE html>
<!-- 共通ヘッダー：サイトタイトルとナビゲーションリンク -->
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <!-- Supabaseライブラリを読み込む -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    nav a {
      transition: transform 0.3s ease;
      display: inline-block;
    }
    nav a:hover {
      transform: scale(1.1);
    }
  </style>
</head>
<header style="background:#2563eb; padding:10px; color:white; display:flex; align-items:center; justify-content:space-between;">
  <div style="display:flex; align-items:center;">
    <h1 style="margin:0;">アクティビティ</h1>
    <!-- ログインユーザ名を表示するエリア -->
    <span id="user-display-name" style="margin-left:20px; font-size:0.9em;"></span>
  </div>
  <nav>
    <a href="sc_time_viewer_8.html" style="color:white; margin-right:15px; text-decoration:none;">
      <i class="fas fa-chart-line"></i> PC使用状況タイムライン
    </a>
    <a href="set_use_time.html" style="color:white; margin-right:15px; text-decoration:none;">
      <i class="fas fa-keyboard"></i> PCアクティビティ登録
    </a>
    <a href="add_time.html" style="color:white; text-decoration:none;">
      <i class="fas fa-clock"></i> PC視聴時間修正
    </a>
  </nav>
</header>

<script>
  document.addEventListener('DOMContentLoaded', async () => {
    const SUPABASE_URL = 'https://xalrqqutkxzwzvahqpjg.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhhbHJxcXV0a3h6d3p2YWhxcGpnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzkyNDE2MDIsImV4cCI6MjA1NDgxNzYwMn0.OzfyNlLHmZJOiWnCgsUCnvA9npaDXzVeASr-HVOT1MA';
    
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
    
    try {
      // セッション情報を取得
      const { data: { session }, error } = await supabaseClient.auth.getSession();
      
      if (error) {
        console.error('セッション取得エラー:', error.message);
        return;
      }
      
      const userDisplay = document.getElementById('user-display-name');
      alert(session);
      if (session && session.user) {
        userDisplay.textContent = `ようこそ, ${session.user.email} さん`;
        console.log('ユーザー情報:', session.user);
      } else {
        console.log('セッションまたはユーザー情報がありません');
        userDisplay.textContent = 'ログインしていません';
      }
    } catch (err) {
      console.error('予期せぬエラー:', err);
    }
  });
</script> 